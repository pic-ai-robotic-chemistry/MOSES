### **AI模型评估项目：最终数据分析与可视化方案 **



你好！欢迎参与本项目。这份文件是你执行数据分析工作的核心指南。项目中，我们使用了9个AI模型对27个相同的问题进行了回答，并邀请了人类评委与一个大语言模型（LLM）作为评委，从4个维度（正确性、完备性、理论深度、严谨性与信息密度）对这些回答进行了打分。你的任务是根据本方案，对评分数据进行全面的分析，以量化和呈现评委们的一致性。

本方案的核心分析框架分为两个层次：

1.  **模型排序分析 (裁判视角)**：评估LLM作为一个“裁判”，其给出的模型优劣排行榜是否与人类一致。
2.  **模型诊断分析 (教练视角)**：评估LLM作为一个“教练”，其对单个模型能力优劣（强项/弱项）的诊断是否与人类一致。

请严格按照以下步骤执行。

**注意**：严禁增删，修改`test_results\eva_res\consistency_analysis`目录以外的文件。你的所有实际改动都应该在该目录下进行，你可以进行子目录的创建，文件的增删和改写，但是仅限此目录下！

------



### **第零部分：背景与数据结构理解**



-   核心数据: 人类评分在test_results\eva_res\human\副本主客体27题论文评测1-27题分数结果（汇总）-0829.csv

    LLM评分在test_results\eva_res\individual\安全前瞻-化学_82_doubao-seed-1.6_安全与前瞻_1755917139543_individual_evaluation_prompts_5x_18900_v1.json

-   **人类评分结构**: 每个 `{模型, 问题}` 的组合，有 **1** 个回答。这个回答由 **3** 位不同的人类评委打分。读取代码可参考`test_results\eva_res\src\humanevas\human_eval_stats.py`

-   **LLM评分结构**: 每个 `{模型, 问题}` 的组合，有 **5** 个不同的回答（生成轮次）。每个回答由同 **1** 个LLM重复打分 **5** 次。读取代码可参考`test_results\eva_res\src\individual.py`

-   **可视化样式配置文件**：`test_results\eva_res\vis\config\vis_config.py`

------



### **第一部分：数据预处理与聚合**



在分析前，必须将原始分数聚合成有意义的代表性分数。

1.  **`Human_Avg`**:
    -   **目的**: 获取人类对某次回答的共识分数。
    -   **计算**: 对于每一个 `{模型, 问题, 维度}` 组合，计算3位人类评委分数的**平均值**。
2.  **`LLM_Avg_Overall`**:
    -   **目的**: 获取LLM对某个模型在某个问题上**综合表现**的评分。
    -   **计算**: 对于每一个 `{模型, 问题, 维度}` 组合，计算其全部25个分数（5个不同回答 × 5次重复评分）的**总平均值**。
3.  **`LLM_Repetition_Avg`**:
    -   **目的**: 获取LLM对**单次回答**的稳定评分（用于计算LLM内部稳定性）。
    -   **计算**: 对于每一个 `{模型, 问题, 维度, 生成轮次}` 组合，计算5次重复评分的**平均值**。
4.  **`Disagreement_Score`**:
    -   **目的**: 计算LLM和人类对同一个 `{模型, 问题, 维度}` 组合评分的差异。
    -   **计算**: `Disagreement_Score = LLM_Avg_Overall - Human_Avg`。

------



### **第二部分：核心分析 I - 模型排序一致性 (裁判视角)**



本部分旨在回答：“LLM作为一个‘裁判’，其评判结果是否可靠且与人类一致？”



#### **2.1 LLM-人类一致性 (裁判一致性)**



-   **计算步骤**:
    1.  以 **“问题”** 和 **“维度”** 为单位进行循环。
    2.  对于某个问题和维度，提取9个 `Human_Avg` 分数和9个 `LLM_Avg_Overall` 分数。
    3.  计算这_两列_（N=9）分数的相关系数：**Kendall's Tau-b (首选)**, **Spearman's Rho (次选)**, 和 **ICC(A,1) (补充)**。
    4.  **【重要：对于每一次相关性计算，都必须同时记录下相关系数值和其对应的p值。Python的`scipy.stats`和`pingouin`库在计算这些系数时都会返回p值。】**
    5.  重复此过程，获得 27 (问题) × 4 (维度) = 108套相关系数值及对应的p值。
-   **报告**:
    -   按维度分组，报告这27个系数值的**平均值**和**99.7%置信区间**。
    -   **【在报告文本中，必须对结果的统计显著性进行说明。可以报告平均p值，或报告在p < 0.05（或更严格的阈值）下显著的结果占比。】**
    -   **【报告示例**: “在‘正确性’维度上，LLM与人类的模型排序一致性表现出统计学上的显著关系（平均Kendall's Tau = 0.75 [99.7% CI: 0.65, 0.85]），表明两者在判断模型相对优劣方面高度一致，且这种一致性极不可能是由随机偶然造成的。”】
-   **可视化**:
    1.  **图A - 分面散点图 (总体趋势)**:
        -   **目的**: 展示LLM与人类评分的总体关系。
        -   **设计**: 创建一个2x2的图表网格，每个子图代表一个维度。X轴为 `Human_Avg`，Y轴为 `LLM_Avg_Overall`。在每个子图中，绘制所有243个数据点，并添加**一条**总体的线性拟合直线和`y=x`参考虚线。
    2.  **图B - 分面散点图 (模型趋势探索)**:
        -   **目的**: 探索不同模型的评分是否存在独特的线性关系或偏差。
        -   **设计**: 与图A结构相同，但图中的243个点需用**9种不同的颜色**加以区分（每种颜色代表一个模型）。移除总体的拟合线，改为为**每个模型的彩色点集分别拟合一条趋势线**。此图用于视觉探索和假设形成。
    3.  **图C - 纵向森林图 (Forest Plot) / 点图 (Dot Plot)**:
        -   **目的**: 精确、清晰地总结和比较不同维度下的一致性强度。
        -   **设计**:
            -   X轴为类别，列出4个维度。
            -   Y轴为相关系数值（例如从0到1）。
            -   在每个维度的水平线上，并排或用不同形状绘制三个点，分别代表**Kendall's Tau, Spearman's Rho, 和ICC的平均值**。
            -   为每个点添加**垂直误差棒**，代表其99.7%置信区间。
            -   此图信息密度高，且能清晰展示测量结果的不确定性，是比条形图更优的选择。



#### **2.2 人类内部一致性 (裁判组内部共识)**



-   **计算步骤**:
    1.  以 **“问题”** 和 **“维度”** 为单位循环。
    2.  提取一个 9 (模型) × 3 (人类评委) 的分数矩阵。
    3.  对此矩阵计算 **ICC(A,1)**。**【同时记录ICC值和其p值。`pingouin.intraclass_corr`函数会返回此信息。】**
    4.  获得108个ICC值和对应的p值。
-   **报告**: 报告这108个ICC值的总体平均值、中位数，并按维度报告平均值。**【同时需要总结ICC值的显著性水平。】**
-   **可视化**:
    -   **小提琴图 (Violin Plot) **: X轴为4个维度，Y轴为ICC系数值。此图展示人类评委在不同维度上的一致性分布情况，比条形图能提供更多关于数据分布的信息。

------



### **第三部分：核心分析 II - 模型诊断一致性 (教练视角)**



本部分旨在回答：“LLM作为一个‘教练’，其对单个模型的诊断是否可靠且与人类一致？”



#### **3.1 LLM-人类一致性 (教练一致性)**



-   **计算步骤**:
    1.  以 **“模型”** 和 **“维度”** 为单位循环。
    2.  对于某个模型和维度，提取其在27个问题上的 `Human_Avg` 和 `LLM_Avg_Overall` 分数。
    3.  计算这两列（N=27）分数的 **Kendall's Tau-b** 系数。**【同时记录系数值和p值。】**
    4.  获得 9 (模型) × 4 (维度) = 36个相关系数值和对应的p值。
-   **报告**: 报告每个模型在不同维度下的“诊断一致性”得分。**【报告格式应为 `τ = 0.xx, p = 0.yyy`。如果p值非常小，记为 科学记数法。】**
-   **可视化**:
    -   **纵向森林图 (Forest Plot)**:
        -   **设计**: X轴为9个AI模型，Y轴为Kendall's Tau-b系数值。图中绘制9个点，每个点代表一个模型的诊断一致性得分，并附带99.7%置信区间的误差棒。可以使用分面来展示4个不同维度的结果。**【可以在图表的注释或标题中总结结果的整体显著性。】**



#### **3.2 人类内部一致性 (教练组内部共识)**



-   **计算步骤**:
    1.  以 **“模型”** 和 **“维度”** 为单位循环。
    2.  提取一个 27 (问题) × 3 (人类评委) 的分数矩阵。
    3.  对此矩阵计算 **ICC(A,1)**。**【同时记录ICC值和p值。】**
    4.  获得36个ICC值和对应的p值。
-   **报告**: 报告每个模型的“人类内部一致性”得分，**【并注明其p值】**。
-   **可视化**:
    -   **纵向森林图 (Forest Plot)**: X轴为9个AI模型，Y轴为ICC系数值。图中绘制9个点，代表每个模型上人类评委的共识度，并附带误差棒。

------



### **第四部分：基础稳定性分析**





#### **4.1 LLM内部一致性 (工具稳定性)**



-   **计算步骤**:
    1.  对**每一个** `{模型, 问题, 维度, 生成轮次}` 组合，提取5次重复评分的向量。
    2.  对每个向量计算 **ICC(1,1)**。**【同时记录ICC值和p值。】**
    3.  获得 4860 个ICC值和对应的p值。
-   **报告**: 报告这数千个ICC值的总体平均值和中位数，**【并总结其显著性，例如，在多大比例的计算中ICC值是统计显著的。】**
-   **可视化**:
    -   **两个小提琴图**:
        1.  第一个图：X轴为4个维度，Y轴为ICC值。
        2.  第二个图：X轴为9个AI模型，Y轴为ICC值。

------



### **第五部分：补充分析 - 误差与偏差探究**



-   **计算步骤**: 使用第一部分计算出的 `Disagreement_Score`。
-   **报告**: 报告每个模型的平均“一致性误差”，判断LLM对哪些模型存在系统性高估或低估。
-   **可视化**:
    -   **“一致性误差”小提琴图**:
        -   X轴为9个AI模型，Y轴为 `Disagreement_Score`。
        -   在Y=0处画一条水平参考线。
        -   小提琴图能比箱形图更清晰地展示误差的分布形状（例如，是双峰分布还是偏态分布），信息量更大。

------



### **第六部分：最终报告叙事结构建议**

在上述工作全部结束后，查看你的输出，包括数据和可视化图表，然后手动构建一份最终报告：

1.  **摘要与引言**: 介绍项目背景、数据和核心研究问题。
2.  **方法论**: 解释数据预处理方法，并清晰定义“模型排序一致性”和“模型诊断一致性”两个分析框架。
3.  **评委可靠性分析**: 首先呈现**人类内部一致性**和**LLM内部一致性**的结果（来自2.2和4.1）。**结论先行**：证明我们的测量过程是**可靠且统计显著的**。
4.  **核心发现：模型排序一致性**: 呈现**方案一**的结果（来自2.1），这是最重要的结论。回答LLM作为“裁判”是否合格，**并用统计显著性支撑该结论**。
5.  **深入分析：模型诊断一致性**: 呈现**方案二**的结果（来自3.1和3.2），并结合**误差分析**（来自第五部分）。深入探讨一致性在不同模型间的差异，并分析其原因。**确保所有结论都有显著性检验的支持**。
6.  **结论与展望**: 总结所有发现，并对未来工作提出建议。